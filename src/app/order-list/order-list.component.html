<div class="orders-page">
  <h1 class="page-title">My Orders</h1>

  <!-- Search bar and status filter -->
  <div class="filter-container">
    <input type="text" [(ngModel)]="searchQuery" (input)="filterOrders()" placeholder="Search by item..." class="search-bar">
    
    <select [(ngModel)]="selectedStatus" (change)="filterOrders()" class="status-filter">
      <option value="">All statuses</option>
      <option value="completed">  Completed</option>
      <option value="pending">Pending</option>
    </select>
  </div>

  <div *ngIf="filteredOrders.length > 0; else noOrders" class="orders-container">
    <div class="order-card" *ngFor="let order of filteredOrders">
      <div class="order-header">
        <div class="order-title">
          <h2>Order #{{ order.id }}</h2>
          <p class="order-date">{{ order.date | date: 'medium' }}</p>
        </div>
        <p class="order-status">
          <span [class]="order.status.toLowerCase()">
            <ng-container *ngIf="order.status.toLowerCase() === 'completed'">
              <i class="fas fa-check-circle"></i>
            </ng-container>
            <ng-container *ngIf="order.status.toLowerCase() === 'pending'">
              <i class='fas fa-hourglass-half'></i>
            </ng-container>
            {{ order.status }}
          </span>
        </p>
      </div>

      <div class="order-details">
        <div class="order-summary">
          <p><i class="fas fa-coins"></i> <strong>Total:</strong> {{ order.total_amount | currency }}</p>
          <p><i class="fas fa-box"></i> <strong>Articles:</strong> {{ order.order_items.length }}</p>
        </div>

        <div class="order-items">
          <h3><i class="fas fa-list"></i> Articles</h3>
          <div class="order-item" *ngFor="let item of order.order_items">
            <div class="item-details">
              <div>
                <p><strong>{{ item.product.name }}</strong></p>
                <p>Quantity: {{ item.quantity }}</p>
              </div>
            </div>
            <p class="item-price">{{ item.product.price | currency }}</p>
          </div>
        </div>
        <div class="download-button-container">
          <button (click)="downloadReceipt(order)" class="download-button">
            <i class="fas fa-download"></i> Download the receipt
          </button>
        </div>
        
        
      </div>
    </div>
  </div>

  <ng-template #noOrders>
    <div class="no-orders">
      <p><i class="fas fa-info-circle"></i> Aucune commande disponible.</p>
    </div>
  </ng-template>
</div>
